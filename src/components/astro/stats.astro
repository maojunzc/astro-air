---
const startTime = new Date('2024-01-01') // åšå®¢å¼€å§‹è¿è¡Œæ—¶é—´
---

<div class="fixed bottom-4 left-1/2 transform -translate-x-1/2 z-50">
  <div class="flex items-center gap-2 rounded-full bg-gray-900 text-white px-4 py-2 shadow-lg">
    <!-- è¿è¡Œæ—¶é—´ -->
    <div class="flex items-center gap-1">
      <span class="text-sm">ğŸ“…</span>
      <span class="text-xs" id="run-time">è®¡ç®—ä¸­...</span>
    </div>
    
    <div class="w-px h-4 bg-gray-700"></div>
    
    <!-- è®¿é—®äººæ•° -->
    <div class="flex items-center gap-1">
      <span class="text-sm">ğŸ‘ï¸</span>
      <span class="text-xs" id="visitor-count">0</span>
    </div>
    
    <div class="w-px h-4 bg-gray-700"></div>
    
    <!-- å·¥å…·æŒ‰é’® -->
    <div class="flex items-center gap-2">
      <a href="/zh" class="p-1 rounded-full hover:bg-gray-800 transition-colors" title="é¦–é¡µ">
        <span class="text-sm">ğŸ </span>
      </a>
      <a href="/zh/archive" class="p-1 rounded-full hover:bg-gray-800 transition-colors" title="å½’æ¡£">
        <span class="text-sm">ğŸ“</span>
      </a>
      <a href="/zh/links" class="p-1 rounded-full hover:bg-gray-800 transition-colors" title="å‹é“¾">
        <span class="text-sm">ğŸ”—</span>
      </a>
      <a href="/zh/about" class="p-1 rounded-full hover:bg-gray-800 transition-colors" title="å…³äº">
        <span class="text-sm">â„¹ï¸</span>
      </a>
    </div>
  </div>
</div>

<script is:inline>
  // è®¡ç®—è¿è¡Œæ—¶é—´ï¼ˆå¹´æœˆæ—¥æ—¶åˆ†ç§’ï¼‰
  function calculateRunTime() {
    const startTime = new Date('2024-01-01');
    const now = new Date();
    
    let diff = Math.floor((now - startTime) / 1000); // æ€»ç§’æ•°
    
    const years = Math.floor(diff / (365 * 24 * 60 * 60));
    diff -= years * 365 * 24 * 60 * 60;
    
    const months = Math.floor(diff / (30 * 24 * 60 * 60));
    diff -= months * 30 * 24 * 60 * 60;
    
    const days = Math.floor(diff / (24 * 60 * 60));
    diff -= days * 24 * 60 * 60;
    
    const hours = Math.floor(diff / (60 * 60));
    diff -= hours * 60 * 60;
    
    const minutes = Math.floor(diff / 60);
    const seconds = diff % 60;
    
    const runTimeString = `${years}å¹´${months}æœˆ${days}å¤© ${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    document.getElementById('run-time').textContent = runTimeString;
  }
  
  // åŸºäºIPçš„è®¿é—®ç»Ÿè®¡
  function updateVisitorCount() {
    // å°è¯•è·å–ç”¨æˆ·IPï¼ˆåœ¨æµè§ˆå™¨ç«¯æœ‰é™åˆ¶ï¼Œè¿™é‡Œä½¿ç”¨ç®€åŒ–æ–¹æ¡ˆï¼‰
    const getClientIP = () => {
      // æµè§ˆå™¨ç«¯æ— æ³•ç›´æ¥è·å–çœŸå®IPï¼Œè¿™é‡Œä½¿ç”¨ç”¨æˆ·ä»£ç†å’Œå±å¹•å°ºå¯¸ä½œä¸ºå”¯ä¸€æ ‡è¯†
      return `${navigator.userAgent}_${screen.width}x${screen.height}_${new Date().getTimezoneOffset()}`;
    };
    
    const userIdentifier = getClientIP();
    
    // ä»localStorageè·å–è®¿é—®è®°å½•
    let visitors = JSON.parse(localStorage.getItem('visitors') || '{}');
    let visitCount = parseInt(localStorage.getItem('visitCount') || '0');
    
    // å¦‚æœæ˜¯æ–°è®¿å®¢ï¼Œå¢åŠ å”¯ä¸€è®¿å®¢æ•°
    if (!visitors[userIdentifier]) {
      visitors[userIdentifier] = new Date().toISOString();
      localStorage.setItem('visitors', JSON.stringify(visitors));
    }
    
    // å¢åŠ æ€»è®¿é—®é‡
    visitCount++;
    localStorage.setItem('visitCount', visitCount.toString());
    
    // è®¡ç®—å”¯ä¸€è®¿å®¢æ•°
    const uniqueVisitors = Object.keys(visitors).length;
    
    // æ˜¾ç¤ºæ€»è®¿é—®é‡
    document.getElementById('visitor-count').textContent = visitCount;
  }
  
  // åˆå§‹åŠ è½½æ—¶æ‰§è¡Œ
  calculateRunTime();
  updateVisitorCount();
  
  // æ¯ç§’æ›´æ–°è¿è¡Œæ—¶é—´
  setInterval(calculateRunTime, 1000);
</script>