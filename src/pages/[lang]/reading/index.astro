---
import { en, zh } from "~/config"
import { getLangFromUrl } from "~/i18n/utils"
import MainLayout from "~/layouts/main.astro"
import { getLanguagePaths } from "~/utils/langs"

// 导入书籍数据
import books from "~/config/books.json"

export function getStaticPaths() {
  return getLanguagePaths()
}

const lang = getLangFromUrl(Astro.url)
const pageMeta = lang === "zh" ? zh.pageMeta : en.pageMeta
const isChinese = lang === "zh"
---

<MainLayout
  title={pageMeta.reading.title}
  description={pageMeta.reading.description}
  ogImage={pageMeta.reading.ogImage}
  needComment={false}
>
  <div class="mx-auto my-10 max-w-4xl">
    <h1 class="mb-8 text-center text-3xl font-bold">
      {isChinese ? "阅读" : "Reading"}
    </h1>

    <!-- 书籍列表 -->
    <div class="grid grid-cols-1 gap-6 sm:grid-cols-2 md:grid-cols-3">
      {
        books && books.length > 0 ? (
          books.map((book, index) => (
            <div
              key={index}
              class="overflow-hidden rounded-lg bg-white shadow-md transition-transform hover:scale-105 dark:bg-gray-800"
            >
              <a
                href={book.link}
                target="_blank"
                rel="noopener noreferrer"
                class="block"
              >
                <div class="flex h-48 cursor-pointer items-center justify-center bg-gradient-to-br from-blue-600 to-blue-800 p-6 text-white transition-opacity hover:opacity-90">
                  <h3 class="text-center text-xl font-bold">{book.title}</h3>
                </div>
              </a>
              <div class="p-4">
                <h3 class="mb-2 text-lg font-semibold">{book.title}</h3>
                <p class="mb-3 text-sm text-gray-600 dark:text-gray-400">
                  {book.author}
                </p>
                <p class="mb-4 line-clamp-2 text-sm text-gray-500 dark:text-gray-400">
                  {isChinese
                    ? book.description
                    : book.descriptionEn || book.description}
                </p>
                <a
                  href={book.link}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="read-button inline-block rounded-md bg-blue-600 px-4 py-2 text-white transition-colors hover:bg-blue-700"
                >
                  {isChinese ? "开始阅读" : "Start Reading"}
                </a>
              </div>
            </div>
          ))
        ) : (
          <div class="col-span-full py-10 text-center">
            <p class="text-gray-600 dark:text-gray-400">
              {isChinese ? "暂无书籍数据" : "No books data available"}
            </p>
          </div>
        )
      }
    </div>

    <!-- 阅读提示 -->
    <div
      class="mt-10 rounded-lg border border-blue-200 bg-blue-50 p-4 dark:border-blue-800 dark:bg-blue-900/20"
    >
      <h3 class="mb-2 text-lg font-semibold text-blue-700 dark:text-blue-400">
        {isChinese ? "阅读提示" : "Reading Tips"}
      </h3>
      <ul
        class="list-inside list-disc space-y-2 text-sm text-gray-700 dark:text-gray-300"
      >
        <li>
          {
            isChinese
              ? "点击书籍封面进入阅读"
              : "Click on the book cover to start reading"
          }
        </li>
        <li>
          {
            isChinese
              ? "可以通过顶部的音乐播放器控制音乐"
              : "You can control music through the top music player"
          }
        </li>
        <li>
          {
            isChinese
              ? "建议在安静的环境中阅读，以获得更好的阅读体验"
              : "It is recommended to read in a quiet environment for a better reading experience"
          }
        </li>
      </ul>
    </div>
  </div>
</MainLayout>
